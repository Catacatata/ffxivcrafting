var food={init:function(){$(".vendors").on("click",function(a){a.preventDefault();var b=$(this),c=b.data("itemId");if(!b.hasClass("loading")){var d=$("#vendors_for_"+c);0==d.length?$.ajax({url:"/vendors/view/"+c,dataType:"json",beforeSend:function(){b.addClass("loading"),global.noty({type:"warning",text:"Loading Vendors"})},success:function(a){$("body").append(a.html),$("#vendors_for_"+c).modal(),b.removeClass("loading")}}):$("#vendors_for_"+c).modal("show")}}),food.grid_events()},grid_events:function(){$(".food-grid td.reveal").click(function(){var a=$(this),b=a.data("a"),c=a.data("b"),d=a.closest(".food-selection"),e=d.find(".items-table"),f=e.find("tbody");e.find("caption h2").html(a.data("originalTitle"));var g=b==c?1:2,h=0;if(!a.hasClass("active")){$(".food-grid td.reveal").removeClass("active"),a.addClass("active"),e.removeClass("hidden"),$("tr",f).addClass("hidden").each(function(){var a=$(this),d=a.data("stats").split("|"),e=0;-1!=d.indexOf(b)&&e++,b!=c&&-1!=d.indexOf(c)&&e++,-1!=d.indexOf("Vitality")&&(h=1,e++),e==g+h&&d.length==g+h&&a.removeClass("hidden")}),g+=h,$(".items-table th, .items-table td").removeClass("hidden"),3>g&&$(".items-table th:nth-child(4), .items-table td:nth-child(4)").addClass("hidden"),2>g&&$(".items-table th:nth-child(3), .items-table td:nth-child(3)").addClass("hidden");var i=[],j="",k="";$("tr:visible",f).each(function(){var a=$(this),b=$("td:first-child a:last-child",a).text(),c=$("td:nth-child(2)",a),d=$("td:nth-child(3)",a);0==d.length&&(d=c),""==j&&(j=c.data("statName")),""==k&&(k=d.data("statName"));var e="hq"==a.data("quality")?" (HQ)":"";i.push({name:b+e,color:"rgb(255, 64, 64)",data:[[c.data("amount"),d.data("amount")]]})}),$(".highchart",d).removeClass("hidden"),$(".highchart",d).highcharts({chart:{type:"scatter",zoomType:"xy"},title:{text:a.data("originalTitle")},xAxis:{title:{enabled:!0,text:j},startOnTick:!0,endOnTick:!0,showLastLabel:!0},yAxis:{title:{text:k}},legend:{enabled:!1},plotOptions:{scatter:{marker:{radius:5,states:{hover:{enabled:!0,lineColor:"rgb(100,100,100)"}}},states:{hover:{marker:{enabled:!1}}},tooltip:{headerFormat:"<b>{series.name}</b><br>",pointFormat:"{point.x} "+j+", {point.y} "+k}}},series:i})}}),$(".items-table .sort").click(function(){{var a=$(this),b=a.closest("table"),c=b.find("tbody");$("tr:visible",c)}b.find(".sort .glyphicon").addClass("glyphicon-sort").removeClass("glyphicon-sort-by-attributes").removeClass("glyphicon-sort-by-attributes-alt");var d="asc"==a.data("order")?"desc":"asc";a.data("order",d),a.find(".glyphicon").removeClass("glyphicon-sort").addClass("glyphicon-sort-by-attributes"+("desc"==d?"-alt":""));var e=c.children("tr:visible").sort(function(b,c){var b=parseInt($(b).find("td:nth-child("+a.data("column")+")").data("amount")),c=parseInt($(c).find("td:nth-child("+a.data("column")+")").data("amount"));return c>b?-1:b>c?1:0});"desc"==d&&(e=Array.prototype.reverse.call(e)),c.append(e)})},sort_using_data:function(){}};$(food.init);